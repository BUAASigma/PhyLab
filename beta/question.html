<!DOCTYPE html>

<head>
    <title>GetQuestion</title>
</head>

<body>

    <div id="question">
        <p qid="0">题目题目题目题目</p>
    </div>
    <div id="options">
        <li>
            <input type="radio" name="option" value="A">A. </li>
        <li>
            <input type="radio" name="option" value="B" checked>B. </li>
        <li>
            <input type="radio" name="option" value="C">C. </li>
        <li>
            <input type="radio" name="option" value="D">D. </li>
    </div>
    <div id="result"></div>
    <button type="button" onclick="alterQuestion(r)">更换题目</button>
    <button type="button" onclick="checkAnswer()">检查答案</button>
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css" integrity="sha384-exe4Ak6B0EoJI0ogGxjJ8rn+RN3ftPnEQrGwX59KTCl5ybGzvHGKjhPKk/KC3abb"
        crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.js" integrity="sha384-OMvkZ24ANLwviZR2lVq8ujbE/bUO8IR1FdBrKLQBI14Gq5Xp/lksIccGkmKL8m+h"
        crossorigin="anonymous"></script>
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js"></script>
    <script type="text/javascript">
        var r =
            {
                qid: 0,
                question: "你好123123123123",
                options: { "A": "hello", "B": "yo", "C": "{{gr}}eetings" },
                type: ""
            };

        function getQuestion() {
            var getQuestionUrl = "";
            var result;
            $.ajax(
                {
                    url: getQuestionUrl,
                    type: "get",
                    data: {},
                    success: function (re) {
                        result = re;
                    }
                }
            );
            return result;
        }

        function alterQuestion(quest) {
            $("#question p").html(render(quest.question), { displayMode: true }).attr("qid", quest.qid);
            $("#options").empty();
            var a = "<li><input type = \"radio\" name = \"option\" value = \"";
            var b = "\">";
            var c = "</li>"
            for (op in quest.options) {
                $("#options").append(a + op + b + render(quest.options[op]) + c);
            }
        }

        function checkAnswer() {
            var checkAnswerUrl = "";
            var ans = $("#options :radio:checked");
            if (ans.length == 0) {
                console.log("must select one");
                return;
            }
            ans = ans[0].value;
            var response;
            response = new Object();
            response.right = 0;
            // console.log(ans);
            // $.ajax(
            //     {
            //         url: checkAnswerUrl,
            //         type: "get",
            //         data: { "qid": 0, "answer": ans },
            //         success: function (re) {
            //             response = re;
            //         }
            //     }
            // );
            if (response.right == 1)
                $("#result").text("正确");
            else
                $("#result").text("错误");

        }
        function getAnswer() {
            var getAnswerUrl = "";
            var qid = $("#question p").attr("qid");
            var response;
            $.ajax(
                {
                    url: getAnswerUrl,
                    type: "get",
                    data: { "qid": qid },
                    success: function (re) { response = re; }
                }
            );
            return response;
        }
        function render(text) {
            return text.replace(/\{\{\w*\}\}/g, function (word) {
                return katex.renderToString(word);
            })
        }
        alterQuestion(r);
    </script>


</body>

</html>